http:
    port: 5001 # 게이트웨이 실행 포트
# admin:
#   port: 9876
#   host: localhost
apiEndpoints:
    authApi:
        host: "*"
        paths: "/api/auth/*"
serviceEndpoints:
    authService:
        url: "http://localhost:5002" # AUTH 서비스 URL
policies:
    - cors
    - log
    - proxy
    - jwt
    # - proxy-with-body
    # - jwtAuth
    # - basic-auth
    # - expression
    # - key-auth
    # - oauth2
    # - rate-limit
pipelines:
    authPipeline:
        apiEndpoints:
            - authApi
        policies:
            # Uncomment `key-auth:` when instructed to in the Getting Started guide.
            # - key-auth:
            - cors: # 맨 위 배치
                  - action:
                        origin: "http://localhost:5000"
                        credentials: true
                        methods: "GET, POST, PUT, DELETE, OPTIONS"
                        allowedHeaders:
                            [
                                "Authorization",
                                "Content-type",
                                "Origin",
                                "Access-Control-Allow-Origin",
                                "Access-Control-Allow-Methods",
                                "Accept",
                                "Options",
                                "Access-Control-Request-Headers",
                                "Access-Control-Request-Method",
                            ]
                        exposedHeaders:
                            [
                                "Authorization",
                                "Content-type",
                                "Origin",
                                "Access-Control-Allow-Origin",
                                "Access-Control-Allow-Methods",
                                "Accept",
                                "Options",
                                "Access-Control-Request-Headers",
                                "Access-Control-Request-Method",
                            ]
                        preflightContinue: false
                        optionsSuccessStatus: 204
            - jwt:
                  - action:
                        secretOrPublicKeyFile: ../keys/public.pem # JWT 검증
                        checkCredentialExistence: false
            - proxy:
                  - action:
                        serviceEndpoint: authService
                        changeOrigin: true
            # - proxy-with-body:
            #       - action:
            #             baseUrl: "http://localhost:5002"
